<!DOCTYPE html>

<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>__ float</title>
</head>

<body>

	<div class="wrapper"></div>


	<style>
		body {
			background: rgb(17, 74, 199);
			margin: 0;
			height: 100vh;
		}

		.wrapper {
			height: 100%;
		}

		.star {
			position: absolute;
			background: white;
			height: 25px;
			width: 10px;
			top: -30px;
			filter: blur(4px);
		}
	</style>

	<script>

		const wrapper = document.querySelector('.wrapper');
		let stars;

		function handleResize() {

			const tracks = window.innerWidth / 40;
			console.log(tracks);


			let html = '';
			for (i = 0; i < tracks; i++) {
				html += `<div class="bar"><div class="star" style="left: ${Math.floor((i + 1) * 40)}px"></div></div>`;
			}

			wrapper.innerHTML = html;
			stars = document.querySelectorAll('.star')
		}

		// from https://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport/7557433#7557433
		function isElementInViewport(el) {
			var rect = el.getBoundingClientRect();

			return (
				rect.top >= 0 &&
				rect.left >= 0 &&
				rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) && /*or $(window).height() */
				rect.right <= (window.innerWidth || document.documentElement.clientWidth) /*or $(window).width() */
			);
		}

		function down(star) {
			if (!star || isElementInViewport(star)) return;
			let position = -30;
			const interval = setInterval(() => {
				star.style['top'] = `${position}px`
				position += 40;
				if (star.offsetTop > (window.innerHeight + 10 || document.documentElement.clientHeight)) clearInterval(interval);
			}, 50)
		}

		function start() {
			const interval = setInterval(() => {
				const num = Math.floor(Math.random() * stars.length);
				const star = stars[num];
				down(star)
			}, 100)
		}

		handleResize();
		start();

		window.addEventListener('resize', handleResize);

	</script>


</body>

</html>